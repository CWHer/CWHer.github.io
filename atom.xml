<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>魍魉的小窝</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-08-12T01:34:22.972Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>CWHer</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>洛谷P1891 疯狂LCM</title>
    <link href="http://yoursite.com/2018/08/12/%E6%B4%9B%E8%B0%B7P1891-%E7%96%AF%E7%8B%82LCM/"/>
    <id>http://yoursite.com/2018/08/12/洛谷P1891-疯狂LCM/</id>
    <published>2018-08-12T01:31:25.000Z</published>
    <updated>2018-08-12T01:34:22.972Z</updated>
    
    <content type="html"><![CDATA[<p><em>lcm</em> 过大无法枚举，考虑枚举<em>gcd</em><br>对于一组<script type="math/tex">gcd\left ( x,n \right )=k</script>，有<script type="math/tex">gcd\left ( \frac{x}{k},\frac{n}{k} \right )=1</script>，且<script type="math/tex">lcm\left(x,n\right)=\frac{xn}{k}</script><br>记</p><script type="math/tex; mode=display">f\left [ k \right ]=\sum_{i=1}^{k}i\left [ gcd\left ( i,k \right )=1 \right ]</script><p>根据定义，若<script type="math/tex">gcd\left ( x,n \right )=1</script>，则<script type="math/tex">gcd\left ( n-x,n \right )=1</script><br>因此</p><script type="math/tex; mode=display">f\left [ k \right ]= \frac{k*\varphi\left [ k \right ]}{2}</script><p>枚举所有的<em>k</em><br>则</p><script type="math/tex; mode=display">\sum lcm\left ( x,n \right )=k*\frac{n}{k}*f\left [ \frac{n}{k} \right ]\left ( k|n,gcd\left ( x,n \right )=k \right )</script><p>复杂度<script type="math/tex">O\left ( T\sqrt{N} \right )</script></p><p><del>直到有一天我被卡了，才发现有复杂度更低的做法</del><br>继续化简上式</p><script type="math/tex; mode=display">\sum lcm\left ( x,n \right )=n*f\left [ \frac{n}{k} \right ]\left ( k|n,gcd\left ( x,n \right )=k \right )</script><p><del>好吧没啥区别</del></p><script type="math/tex; mode=display">\sum_{i=1}^{n}lcm(i,n)=\sum _{d\mid n}f\left [ d \right ]*n</script><p>可以<script type="math/tex">O\left ( NlogN \right )</script>，<script type="math/tex">O\left (1 \right )</script>回答<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1000050</span>;</span><br><span class="line"><span class="keyword">int</span> phi[N],prime[N],cnt=<span class="number">0</span>;</span><br><span class="line">LL f[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> ((ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&amp;&amp;ch!=<span class="string">'-'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) &#123;t=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!phi[i]) prime[++cnt]=i,phi[i]=i<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=cnt;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((LL)i*prime[j]&gt;N) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span> (i%prime[j]==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                phi[i*prime[j]]=phi[i]*prime[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> phi[i*prime[j]]=phi[i]*(prime[j]<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;N;i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;N;j+=i)</span><br><span class="line">            f[j]+=(LL)phi[i]*i/<span class="number">2</span>*j;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;i++) f[i]+=i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">int</span> T=read();</span><br><span class="line">    <span class="keyword">while</span> (T--) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[read()]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;lcm&lt;/em&gt; 过大无法枚举，考虑枚举&lt;em&gt;gcd&lt;/em&gt;&lt;br&gt;对于一组&lt;script type=&quot;math/tex&quot;&gt;gcd\left ( x,n \right )=k&lt;/script&gt;，有&lt;script type=&quot;math/tex&quot;&gt;gcd\left ( \frac{x}{k},\frac{n}{k} \right )=1&lt;/script&gt;，且&lt;script type=&quot;math/tex&quot;&gt;lcm\left(x,n\right)=\frac{xn}{k}&lt;/script&gt;&lt;br&gt;记&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
f\left [ k \right ]=\sum_{i=1}^{k}i\left [ gcd\left ( i,k \right )=1 \right ]&lt;/script&gt;&lt;p&gt;根据定义，若&lt;script type=&quot;math/tex&quot;&gt;gcd\left ( x,n \right )=1&lt;/script&gt;，则&lt;script type=&quot;math/tex&quot;&gt;gcd\left ( n-x,n \right )=1&lt;/script&gt;&lt;br&gt;因此&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
f\left [ k \right ]= \frac{k*\varphi\left [ k \right ]}{2}&lt;/script&gt;&lt;p&gt;枚举所有的&lt;em&gt;k&lt;/em&gt;&lt;br&gt;则&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\sum lcm\left ( x,n \right )=k*\frac{n}{k}*f\left [ \frac{n}{k} \right ]\left ( k|n,gcd\left ( x,n \right )=k \right )&lt;/script&gt;&lt;p&gt;复杂度&lt;script type=&quot;math/tex&quot;&gt;O\left ( T\sqrt{N} \right )&lt;/script&gt;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;直到有一天我被卡了，才发现有复杂度更低的做法&lt;/del&gt;&lt;br&gt;继续化简上式&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\sum lcm\left ( x,n \right )=n*f\left [ \frac{n}{k} \right ]\left ( k|n,gcd\left ( x,n \right )=k \right )&lt;/script&gt;&lt;p&gt;&lt;del&gt;好吧没啥区别&lt;/del&gt;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\sum_{i=1}^{n}lcm(i,n)=\sum _{d\mid n}f\left [ d \right ]*n&lt;/script&gt;&lt;p&gt;可以&lt;script type=&quot;math/tex&quot;&gt;O\left ( NlogN \right )&lt;/script&gt;，&lt;script type=&quot;math/tex&quot;&gt;O\left (1 \right )&lt;/script&gt;回答&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="数论" scheme="http://yoursite.com/tags/%E6%95%B0%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>洛谷P4626 一道水题 II</title>
    <link href="http://yoursite.com/2018/08/12/%E6%B4%9B%E8%B0%B7P4626-%E4%B8%80%E9%81%93%E6%B0%B4%E9%A2%98-II/"/>
    <id>http://yoursite.com/2018/08/12/洛谷P4626-一道水题-II/</id>
    <published>2018-08-12T01:09:45.000Z</published>
    <updated>2018-08-12T01:19:02.649Z</updated>
    
    <content type="html"><![CDATA[<p>根据定义，不难得出</p><script type="math/tex; mode=display">LCM\left ( 1,n \right )=\prod _{p_{i}\in \mathbb{P},p_{i}\leq n}p_{i}^{\left \lfloor log_{p_{i}}n \right \rfloor}</script><p>筛一遍素数之后暴力统计即可</p><p>空间不够就压位筛</p><p>对于多次询问，观察到<script type="math/tex">p_{i}> \sqrt{n}</script>的指数均为<em>1</em><br>可以求一遍乘积前缀和，将复杂度降为<script type="math/tex">O\left ( T\sqrt{N} \right )</script></p><p>最重要的是，这题模数是<script type="math/tex">1e8+7</script>，不是<script type="math/tex">1e9+7</script>！<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100000050</span>,M=<span class="number">60</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">100000007</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span><span class="keyword">int</span> sz,id;&#125;;</span><br><span class="line">LL used[N/M];</span><br><span class="line"><span class="keyword">int</span> prime[N&gt;&gt;<span class="number">3</span>];</span><br><span class="line">LL cnt=<span class="number">0</span>,n,ans;</span><br><span class="line"><span class="function">LL <span class="title">pow</span><span class="params">(LL a,LL b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL ret=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (b&amp;<span class="number">1</span>) ret=ret*a%mod;</span><br><span class="line">        a=a*a%mod,b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node <span class="title">F</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;<span class="keyword">return</span> (node)&#123;k/M,k%M?k%M:M&#125;;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n),ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        node x=F(i);</span><br><span class="line">        <span class="keyword">if</span> ((used[x.sz]&gt;&gt;x.id)&amp;<span class="number">1</span>^<span class="number">1</span>) prime[++cnt]=i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=cnt;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((LL)i*prime[j]&gt;n) <span class="keyword">break</span>;</span><br><span class="line">            node w=F(i*prime[j]);</span><br><span class="line">            used[w.sz]|=<span class="number">1L</span>L&lt;&lt;w.id;</span><br><span class="line">            <span class="keyword">if</span> (i%prime[j]==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=cnt,k=<span class="number">1</span>;i&gt;<span class="number">0</span>;i--)</span><br><span class="line">    &#123;</span><br><span class="line">        LL x=<span class="built_in">pow</span>(prime[i],k);</span><br><span class="line">        <span class="keyword">while</span> ((LL)x*prime[i]&lt;=n) k++,x*=prime[i];</span><br><span class="line">        ans=ans*x%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);  </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;根据定义，不难得出&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
LCM\left ( 1,n \right )=\prod _{p_{i}\in \mathbb{P},p_{i}\leq n}p_{i}^{\left \lfloor log_{p_{i}}n \right \rfloor}&lt;/script&gt;&lt;p&gt;筛一遍素数之后暴力统计即可&lt;/p&gt;
&lt;p&gt;空间不够就压位筛&lt;/p&gt;
&lt;p&gt;对于多次询问，观察到&lt;script type=&quot;math/tex&quot;&gt;p_{i}&gt; \sqrt{n}&lt;/script&gt;的指数均为&lt;em&gt;1&lt;/em&gt;&lt;br&gt;可以求一遍乘积前缀和，将复杂度降为&lt;script type=&quot;math/tex&quot;&gt;O\left ( T\sqrt{N} \right )&lt;/script&gt;&lt;/p&gt;
&lt;p&gt;最重要的是，这题模数是&lt;script type=&quot;math/tex&quot;&gt;1e8+7&lt;/script&gt;，不是&lt;script type=&quot;math/tex&quot;&gt;1e9+7&lt;/script&gt;！&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="数论" scheme="http://yoursite.com/tags/%E6%95%B0%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>[USACO5.1]圈奶牛</title>
    <link href="http://yoursite.com/2018/08/12/USACO5-1-%E5%9C%88%E5%A5%B6%E7%89%9B/"/>
    <id>http://yoursite.com/2018/08/12/USACO5-1-圈奶牛/</id>
    <published>2018-08-12T00:59:05.000Z</published>
    <updated>2018-08-12T01:08:26.755Z</updated>
    
    <content type="html"><![CDATA[<p>先上图<br><img src="/2018/08/12/USACO5-1-圈奶牛/Graham.gif" alt="Graham"><br>传统的<em>Graham</em> 扫描法<br>先排序，从左到右，从下到上<br>做两边，分别做上半部分和下半部分<br>用栈维护点，发现是凹的就退栈，但起点不能弹掉<del>（WA了好久）</del><br>三点方向可用叉积判断<br>每一遍做完后栈中剩下的元素就是凸包的顶点<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">10050</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps=<span class="number">1e-8</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dot</span>&#123;</span><span class="keyword">double</span> x,y;&#125;;</span><br><span class="line">dot w[N];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">double</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;dot&gt; S;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(dot a,dot b)</span> </span>&#123;<span class="keyword">return</span> <span class="built_in">fabs</span>(a.x-b.x)&lt;eps?a.y&lt;a.y:a.x&lt;b.x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">sqr</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;<span class="keyword">return</span> x*x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dist</span><span class="params">(dot a,dot b)</span> </span>&#123;<span class="keyword">return</span> <span class="built_in">sqrt</span>(sqr(a.x-b.x)+sqr(a.y-b.y));&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(dot a,dot b,dot c)</span> </span>&#123;<span class="keyword">return</span> (b.x-a.x)*(c.y-a.y)-(b.y-a.y)*(c.x-a.x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>,&amp;w[i].x,&amp;w[i].y);</span><br><span class="line">    sort(w+<span class="number">1</span>,w+n+<span class="number">1</span>,cmp);</span><br><span class="line">    S.push_back(w[<span class="number">1</span>]),S.push_back(w[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">3</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (S.size()!=<span class="number">1</span>&amp;&amp;cross(S[S.size()<span class="number">-2</span>],S.back(),w[i])&lt;<span class="number">0</span>) S.pop_back();</span><br><span class="line">        S.push_back(w[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;S.size();i++) ans+=dist(S[i],S[i<span class="number">-1</span>]);</span><br><span class="line">    S.clear();</span><br><span class="line">    S.push_back(w[<span class="number">1</span>]),S.push_back(w[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">3</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (S.size()!=<span class="number">1</span>&amp;&amp;cross(S[S.size()<span class="number">-2</span>],S.back(),w[i])&gt;<span class="number">0</span>) S.pop_back();</span><br><span class="line">        S.push_back(w[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;S.size();i++) ans+=dist(S[i],S[i<span class="number">-1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.2lf"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;先上图&lt;br&gt;&lt;img src=&quot;/2018/08/12/USACO5-1-圈奶牛/Graham.gif&quot; alt=&quot;Graham&quot;&gt;&lt;br&gt;传统的&lt;em&gt;Graham&lt;/em&gt; 扫描法&lt;br&gt;先排序，从左到右，从下到上&lt;br&gt;做两边，分别做上半部分和下半部分&lt;br&gt;用栈维护点，发现是凹的就退栈，但起点不能弹掉&lt;del&gt;（WA了好久）&lt;/del&gt;&lt;br&gt;三点方向可用叉积判断&lt;br&gt;每一遍做完后栈中剩下的元素就是凸包的顶点&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="计算几何" scheme="http://yoursite.com/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/"/>
    
      <category term="凸包" scheme="http://yoursite.com/tags/%E5%87%B8%E5%8C%85/"/>
    
  </entry>
  
  <entry>
    <title>[NOIP2017]逛公园</title>
    <link href="http://yoursite.com/2018/08/12/NOIP2017-%E9%80%9B%E5%85%AC%E5%9B%AD/"/>
    <id>http://yoursite.com/2018/08/12/NOIP2017-逛公园/</id>
    <published>2018-08-12T00:37:34.000Z</published>
    <updated>2018-08-12T00:54:11.797Z</updated>
    
    <content type="html"><![CDATA[<p><del>当年天真的我以为最短路图是有环的，然后翻了车</del></p><p>首先跑一遍<script type="math/tex">S</script>的最短路，记为<script type="math/tex">d</script><br>用<script type="math/tex">dp\left [ x \right ][i]</script>记录点<script type="math/tex">x</script>，距离<script type="math/tex">\leq d_{x}+i</script>的方案数<br>转移方程如下</p><script type="math/tex; mode=display">dp\left [ x \right ]\left [ i \right ]+=dp\left [ to \right ]\left [ i+d_{x}-d_{to}-val_{x-to} \right ]</script><p>这里的<script type="math/tex">x-to</script>是反图上的边<br>答案就是<script type="math/tex">dp\left [ T \right ]\left [ K \right ]</script>，初始化所有<script type="math/tex">dp\left [ S \right ]</script>为<em>1</em></p><p>对于<em>0</em> 环，比较好的一种处理方式是记忆优化搜索<br>当处理<script type="math/tex">\left ( x,i \right )</script>时，再次搜到<script type="math/tex">\left ( x,i \right )</script>，则说明图中存在<em>0</em> 环<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100050</span>,INF=<span class="number">1</span>&lt;&lt;<span class="number">30</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,K,mod,used[N][<span class="number">55</span>];</span><br><span class="line"><span class="keyword">int</span> dp[N][<span class="number">55</span>],d[N],inq[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; e[N],g[N],r[N],f[N];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch!=<span class="string">'-'</span>&amp;&amp;(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) t=<span class="number">-1</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) x=x*<span class="number">10</span>+ch<span class="number">-48</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span><span class="params">(<span class="keyword">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) d[i]=INF;</span><br><span class="line">    d[s]=<span class="number">0</span>,inq[s]=<span class="number">1</span>,Q.push(s);</span><br><span class="line">    <span class="keyword">while</span> (!Q.empty())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x=Q.front();</span><br><span class="line">        Q.pop(),inq[x]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;e[x].size();i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> to=e[x][i],val=g[x][i];</span><br><span class="line">            <span class="keyword">if</span> (d[x]+val&lt;d[to])</span><br><span class="line">            &#123;</span><br><span class="line">                d[to]=d[x]+val;</span><br><span class="line">                <span class="keyword">if</span> (!inq[to]) Q.push(to),inq[to]=<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (used[o][k]) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> (dp[o][k]) <span class="keyword">return</span> dp[o][k];</span><br><span class="line">    <span class="keyword">if</span> (o==<span class="number">1</span>) dp[o][k]=<span class="number">1</span>;</span><br><span class="line">    used[o][k]=<span class="number">1</span>; </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;r[o].size();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> to=r[o][i];</span><br><span class="line">        <span class="keyword">int</span> val=d[to]+f[o][i]-d[o];</span><br><span class="line">        <span class="keyword">if</span> (val&lt;=k)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (dfs(to,k-val)==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">            dp[o][k]=(dp[o][k]+dp[to][k-val])%mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    used[o][k]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> dp[o][K];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T=read();</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        n=read(),m=read(),K=read(),mod=read(); </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) e[i].clear();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) g[i].clear();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) r[i].clear();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) f[i].clear();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> u=read(),v=read();</span><br><span class="line">            <span class="keyword">int</span> val=read();</span><br><span class="line">            e[u].push_back(v);</span><br><span class="line">            r[v].push_back(u);</span><br><span class="line">            f[v].push_back(val);</span><br><span class="line">            g[u].push_back(val); </span><br><span class="line">        &#125;</span><br><span class="line">        SPFA(<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">memset</span>(dp,<span class="number">0</span>,<span class="keyword">sizeof</span>(dp));</span><br><span class="line">        <span class="built_in">memset</span>(used,<span class="number">0</span>,<span class="keyword">sizeof</span>(used));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,dfs(n,K));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;del&gt;当年天真的我以为最短路图是有环的，然后翻了车&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;首先跑一遍&lt;script type=&quot;math/tex&quot;&gt;S&lt;/script&gt;的最短路，记为&lt;script type=&quot;math/tex&quot;&gt;d&lt;/script&gt;&lt;br&gt;用&lt;script type=&quot;math/tex&quot;&gt;dp\left [ x \right ][i]&lt;/script&gt;记录点&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;，距离&lt;script type=&quot;math/tex&quot;&gt;\leq d_{x}+i&lt;/script&gt;的方案数&lt;br&gt;转移方程如下&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
dp\left [ x \right ]\left [ i \right ]+=dp\left [ to \right ]\left [ i+d_{x}-d_{to}-val_{x-to} \right ]&lt;/script&gt;&lt;p&gt;这里的&lt;script type=&quot;math/tex&quot;&gt;x-to&lt;/script&gt;是反图上的边&lt;br&gt;答案就是&lt;script type=&quot;math/tex&quot;&gt;dp\left [ T \right ]\left [ K \right ]&lt;/script&gt;，初始化所有&lt;script type=&quot;math/tex&quot;&gt;dp\left [ S \right ]&lt;/script&gt;为&lt;em&gt;1&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;对于&lt;em&gt;0&lt;/em&gt; 环，比较好的一种处理方式是记忆优化搜索&lt;br&gt;当处理&lt;script type=&quot;math/tex&quot;&gt;\left ( x,i \right )&lt;/script&gt;时，再次搜到&lt;script type=&quot;math/tex&quot;&gt;\left ( x,i \right )&lt;/script&gt;，则说明图中存在&lt;em&gt;0&lt;/em&gt; 环&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="DP" scheme="http://yoursite.com/tags/DP/"/>
    
      <category term="最短路" scheme="http://yoursite.com/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/"/>
    
  </entry>
  
  <entry>
    <title>洛谷P2662 牛场围栏</title>
    <link href="http://yoursite.com/2018/08/12/%E6%B4%9B%E8%B0%B7P2662-%E7%89%9B%E5%9C%BA%E5%9B%B4%E6%A0%8F/"/>
    <id>http://yoursite.com/2018/08/12/洛谷P2662-牛场围栏/</id>
    <published>2018-08-12T00:03:04.000Z</published>
    <updated>2018-08-12T00:35:59.620Z</updated>
    
    <content type="html"><![CDATA[<p>首先随便找一种长度的围栏，比如<script type="math/tex">p</script><br>设<script type="math/tex">d\left [ r \right ]\equiv r\left ( mod \ p \right )</script>，且为最小的不能修建的长度<br>根据定义，<script type="math/tex">d\left [ r \right ]+t*p\left ( t \in \mathbb{N} \right )</script>均能修建，<script type="math/tex">d\left [ r \right ]+t*p\left ( t < 0\right )</script>均不能修建</p><p>求<script type="math/tex">d</script>的过程就是求最短路<br>首先<script type="math/tex">d\left [ 0 \right ]=0</script>，其次可用<script type="math/tex">d\left [ x \right ]+a_{i}</script>更新<script type="math/tex">d\left [ \left ( x+a_{i} \right ) mod \ p\right ]</script><br>显然<script type="math/tex">p</script>越小，复杂度越低<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">3050</span>,INF=<span class="number">1</span>&lt;&lt;<span class="number">30</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,d[N],inq[N],mod,ans;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; w;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch!=<span class="string">'-'</span>&amp;&amp;(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) t=<span class="number">-1</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) x=x*<span class="number">10</span>+ch<span class="number">-48</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;mod;i++) d[i]=INF;</span><br><span class="line">    d[<span class="number">0</span>]=<span class="number">0</span>,inq[<span class="number">0</span>]=<span class="number">1</span>,Q.push(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">while</span> (!Q.empty())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x=Q.front();</span><br><span class="line">        Q.pop(),inq[x]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;w.size();i++)</span><br><span class="line">            <span class="keyword">if</span> (d[x]+w[i]&lt;d[(x+w[i])%mod])</span><br><span class="line">            &#123;</span><br><span class="line">                d[(x+w[i])%mod]=d[x]+w[i];</span><br><span class="line">                <span class="keyword">if</span> (!inq[(x+w[i])%mod])</span><br><span class="line">                &#123;</span><br><span class="line">                    inq[(x+w[i])%mod]=<span class="number">1</span>;</span><br><span class="line">                    Q.push((x+w[i])%mod);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n=read(),m=read();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x=read();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k=x;k&gt;=max(<span class="number">1</span>,x-m);k--) w.push_back(k);</span><br><span class="line">    &#125;</span><br><span class="line">    sort(w.begin(),w.end());</span><br><span class="line">    w.resize(unique(w.begin(),w.end())-w.begin());</span><br><span class="line">    <span class="keyword">if</span> ((mod=w[<span class="number">0</span>])==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    SPFA();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;mod;i++)</span><br><span class="line">        <span class="keyword">if</span> (d[i]==INF)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;mod;i++)</span><br><span class="line">        ans=max(ans,d[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans-mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;首先随便找一种长度的围栏，比如&lt;script type=&quot;math/tex&quot;&gt;p&lt;/script&gt;&lt;br&gt;设&lt;script type=&quot;math/tex&quot;&gt;d\left [ r \right ]\equiv r\left ( mod \ p \right )&lt;/script&gt;，且为最小的不能修建的长度&lt;br&gt;根据定义，&lt;script type=&quot;math/tex&quot;&gt;d\left [ r \right ]+t*p\left ( t \in \mathbb{N} \right )&lt;/script&gt;均能修建，&lt;script type=&quot;math/tex&quot;&gt;d\left [ r \right ]+t*p\left ( t &lt; 0\right )&lt;/script&gt;均不能修建&lt;/p&gt;
&lt;p&gt;求&lt;script type=&quot;math/tex&quot;&gt;d&lt;/script&gt;的过程就是求最短路&lt;br&gt;首先&lt;script type=&quot;math/tex&quot;&gt;d\left [ 0 \right ]=0&lt;/script&gt;，其次可用&lt;script type=&quot;math/tex&quot;&gt;d\left [ x \right ]+a_{i}&lt;/script&gt;更新&lt;script type=&quot;math/tex&quot;&gt;d\left [ \left ( x+a_{i} \right ) mod \ p\right ]&lt;/script&gt;&lt;br&gt;显然&lt;script type=&quot;math/tex&quot;&gt;p&lt;/script&gt;越小，复杂度越低&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="最短路" scheme="http://yoursite.com/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/"/>
    
      <category term="同余" scheme="http://yoursite.com/tags/%E5%90%8C%E4%BD%99/"/>
    
  </entry>
  
  <entry>
    <title>割点</title>
    <link href="http://yoursite.com/2018/08/12/%E5%89%B2%E7%82%B9/"/>
    <id>http://yoursite.com/2018/08/12/割点/</id>
    <published>2018-08-11T23:36:50.000Z</published>
    <updated>2018-08-11T23:54:44.161Z</updated>
    
    <content type="html"><![CDATA[<p>当且仅当点<script type="math/tex">x</script>，存在一个子节点<script type="math/tex">dfn\left [ x \right ]\leq low\left [ x_{son}\right ]</script>，点<script type="math/tex">x</script>是割点<br>特别地，若<script type="math/tex">x</script>为搜索树的根，只要它有两个或以上子节点，它就是割点<br>因为是小于等于，所以在求割点时，不必考虑父节点和重边问题<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100050</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,low[N],dfn[N],num=<span class="number">0</span>,cut[N],cnt=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; e[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> ((ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&amp;&amp;ch!=<span class="string">'-'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) &#123;t=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> son=<span class="number">0</span>;</span><br><span class="line">    low[o]=dfn[o]=++num;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;e[o].size();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> to=e[o][i];</span><br><span class="line">        <span class="keyword">if</span> (!dfn[to])</span><br><span class="line">        &#123;</span><br><span class="line">            tarjan(to,fa);</span><br><span class="line">            low[o]=min(low[o],low[to]);</span><br><span class="line">            <span class="keyword">if</span> (low[to]&gt;=dfn[o]&amp;&amp;o!=fa) cut[o]=<span class="number">1</span>;</span><br><span class="line">            son++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> low[o]=min(low[o],dfn[to]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (o==fa&amp;&amp;son&gt;=<span class="number">2</span>) cut[o]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n=read(),m=read();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> u=read(),v=read();</span><br><span class="line">        e[u].push_back(v);</span><br><span class="line">        e[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">if</span> (!dfn[i]) tarjan(i,i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">if</span> (cut[i]) cnt++;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,cnt);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">if</span> (cut[i]) <span class="built_in">printf</span>(<span class="string">"%d "</span>,i);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;当且仅当点&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;，存在一个子节点&lt;script type=&quot;math/tex&quot;&gt;dfn\left [ x \right ]\leq low\left [ x_{son}\right ]&lt;/script&gt;，点&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;是割点&lt;br&gt;特别地，若&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;为搜索树的根，只要它有两个或以上子节点，它就是割点&lt;br&gt;因为是小于等于，所以在求割点时，不必考虑父节点和重边问题&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="模板" scheme="http://yoursite.com/tags/%E6%A8%A1%E6%9D%BF/"/>
    
      <category term="割点" scheme="http://yoursite.com/tags/%E5%89%B2%E7%82%B9/"/>
    
      <category term="图论" scheme="http://yoursite.com/tags/%E5%9B%BE%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>割边</title>
    <link href="http://yoursite.com/2018/08/12/%E5%89%B2%E8%BE%B9/"/>
    <id>http://yoursite.com/2018/08/12/割边/</id>
    <published>2018-08-11T23:29:41.000Z</published>
    <updated>2018-08-12T00:01:25.694Z</updated>
    
    <content type="html"><![CDATA[<p>当且仅当<script type="math/tex">edge\left ( u,v \right )</script>，存在<script type="math/tex">dfn\left [ u \right ]<low\left [ v \right ]</script>，它为桥<br>需要注意的是，当存在重边时，<script type="math/tex">dfn\left [ fa \right ]</script>可以用来更新<script type="math/tex">low\left [ x \right ]</script><br><a id="more"></a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">10050</span>,M=<span class="number">100050</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,num,low[N],dfn[N],cut[M];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; e[N],g[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch!=<span class="string">'-'</span>&amp;&amp;(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) t=<span class="number">-1</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) x=x*<span class="number">10</span>+ch<span class="number">-48</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[u].push_back(v);</span><br><span class="line">    g[u].push_back(id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    low[o]=dfn[o]=++num;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;e[o].size();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> to=e[o][i];</span><br><span class="line">        <span class="keyword">if</span> (!dfn[to])</span><br><span class="line">        &#123;</span><br><span class="line">            tarjan(to,g[o][i]);</span><br><span class="line">            low[o]=min(low[o],low[to]);</span><br><span class="line">            <span class="keyword">if</span> (low[to]&gt;dfn[o]) cut[g[o][i]]=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (g[o][i]!=id)</span><br><span class="line">            low[o]=min(low[o],dfn[to]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T=read();</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        n=read(),m=read(),num=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) e[i].clear();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) g[i].clear();</span><br><span class="line">        <span class="built_in">memset</span>(low,<span class="number">0</span>,<span class="keyword">sizeof</span>(low));</span><br><span class="line">        <span class="built_in">memset</span>(dfn,<span class="number">0</span>,<span class="keyword">sizeof</span>(dfn));</span><br><span class="line">        <span class="built_in">memset</span>(cut,<span class="number">0</span>,<span class="keyword">sizeof</span>(cut));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> u=read(),v=read();</span><br><span class="line">            add(u,v,i),add(v,u,i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">            <span class="keyword">if</span> (!dfn[i]) tarjan(i,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) </span><br><span class="line">            <span class="keyword">if</span> (cut[i]) ans++;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">            <span class="keyword">if</span> (cut[i]) <span class="built_in">printf</span>(<span class="string">"%d "</span>,i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;当且仅当&lt;script type=&quot;math/tex&quot;&gt;edge\left ( u,v \right )&lt;/script&gt;，存在&lt;script type=&quot;math/tex&quot;&gt;dfn\left [ u \right ]&lt;low\left [ v \right ]&lt;/script&gt;，它为桥&lt;br&gt;需要注意的是，当存在重边时，&lt;script type=&quot;math/tex&quot;&gt;dfn\left [ fa \right ]&lt;/script&gt;可以用来更新&lt;script type=&quot;math/tex&quot;&gt;low\left [ x \right ]&lt;/script&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="模板" scheme="http://yoursite.com/tags/%E6%A8%A1%E6%9D%BF/"/>
    
      <category term="图论" scheme="http://yoursite.com/tags/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="割边" scheme="http://yoursite.com/tags/%E5%89%B2%E8%BE%B9/"/>
    
  </entry>
  
  <entry>
    <title>[NOI2002]银河英雄传说</title>
    <link href="http://yoursite.com/2018/08/11/NOI2002-%E9%93%B6%E6%B2%B3%E8%8B%B1%E9%9B%84%E4%BC%A0%E8%AF%B4/"/>
    <id>http://yoursite.com/2018/08/11/NOI2002-银河英雄传说/</id>
    <published>2018-08-11T13:17:17.000Z</published>
    <updated>2018-08-11T13:22:10.537Z</updated>
    
    <content type="html"><![CDATA[<p>在记录<script type="math/tex">fa</script>的同时记录与<script type="math/tex">fa</script>的距离<script type="math/tex">d</script><br>初始化<script type="math/tex">d</script>为0<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">30050</span>;</span><br><span class="line"><span class="keyword">int</span> fa[N],d[N],sz[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch!=<span class="string">'-'</span>&amp;&amp;(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) t=<span class="number">-1</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) x=x*<span class="number">10</span>+ch<span class="number">-48</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">get</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch!=<span class="string">'M'</span>&amp;&amp;ch!=<span class="string">'C'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">return</span> ch;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (fa[x]==x) <span class="keyword">return</span> x;</span><br><span class="line">    find(fa[x]);</span><br><span class="line">    d[x]+=d[fa[x]];</span><br><span class="line">    <span class="keyword">return</span> fa[x]=find(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">unite</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span> <span class="comment">//u&gt;&gt;v</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    u=find(u),v=find(v);</span><br><span class="line">    fa[u]=v;</span><br><span class="line">    d[u]=d[v]+sz[v];</span><br><span class="line">    sz[v]+=sz[u];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (find(u)!=find(v)) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(d[u]-d[v])<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;i++)</span><br><span class="line">        fa[i]=i,d[i]=<span class="number">0</span>,sz[i]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">int</span> T=read();</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">char</span> opt=get();</span><br><span class="line">        <span class="keyword">int</span> u=read(),v=read();</span><br><span class="line">        <span class="keyword">if</span> (opt==<span class="string">'M'</span>) unite(u,v);</span><br><span class="line">        <span class="keyword">if</span> (opt==<span class="string">'C'</span>) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(u,v));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在记录&lt;script type=&quot;math/tex&quot;&gt;fa&lt;/script&gt;的同时记录与&lt;script type=&quot;math/tex&quot;&gt;fa&lt;/script&gt;的距离&lt;script type=&quot;math/tex&quot;&gt;d&lt;/script&gt;&lt;br&gt;初始化&lt;script type=&quot;math/tex&quot;&gt;d&lt;/script&gt;为0&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="并查集" scheme="http://yoursite.com/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>[NOI2001]炮兵阵地</title>
    <link href="http://yoursite.com/2018/08/11/NOI2001-%E7%82%AE%E5%85%B5%E9%98%B5%E5%9C%B0/"/>
    <id>http://yoursite.com/2018/08/11/NOI2001-炮兵阵地/</id>
    <published>2018-08-11T10:59:23.000Z</published>
    <updated>2018-08-11T11:07:37.268Z</updated>
    
    <content type="html"><![CDATA[<p>先预处理出一行内所有可行方案，记为<script type="math/tex">s</script>，可以发现可行解并不多<br>再预处理出所有可行方案的炮兵数目，记为<script type="math/tex">w</script><br>用<script type="math/tex">dp\left [  d\right ]\left [  i\right ]\left [ j \right ]</script>记录前<script type="math/tex">d</script>行，且上一行状态为<script type="math/tex">s_{j}</script>，上两行状态为<script type="math/tex">s_{i}</script>的最大炮兵数目</p><script type="math/tex; mode=display">dp\left [ d \right ]\left [ j \right ]\left [ k \right ]=max\left \{ dp\left [ d-1 \right ]\left [ i \right ]\left [ j \right ]\right \}</script><p>转移时需要判断状态之间是否合法，炮兵是否均在平原<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">105</span>,M=<span class="number">65</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,dp[N][M][M],f[N];</span><br><span class="line"><span class="keyword">int</span> cnt=<span class="number">0</span>,c[M],w[M],ans=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch!=<span class="string">'-'</span>&amp;&amp;(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) t=<span class="number">-1</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) x=x*<span class="number">10</span>+ch<span class="number">-48</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">get</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch!=<span class="string">'P'</span>&amp;&amp;ch!=<span class="string">'H'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">return</span> ch;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n=read(),m=read();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> s=<span class="number">0</span>;s&lt;(<span class="number">1</span>&lt;&lt;m);s++)</span><br><span class="line">        <span class="keyword">if</span> (!((s&gt;&gt;<span class="number">1</span>)&amp;s)&amp;&amp;!((s&lt;&lt;<span class="number">1</span>)&amp;s))</span><br><span class="line">            <span class="keyword">if</span> (!((s&gt;&gt;<span class="number">2</span>)&amp;s)&amp;&amp;!((s&lt;&lt;<span class="number">2</span>)&amp;s)) c[++cnt]=s;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;j++)</span><br><span class="line">            f[i]+=(get()==<span class="string">'H'</span>)&lt;&lt;(m-j);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=cnt;i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=m;k++)</span><br><span class="line">            w[i]+=(c[i]&gt;&gt;(k<span class="number">-1</span>))&amp;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> d=<span class="number">1</span>;d&lt;=n;d++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=cnt;k++) <span class="keyword">if</span> (!(f[d]&amp;c[k]))</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=cnt;i++)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=cnt;j++) <span class="keyword">if</span> (!(c[i]&amp;c[j]))</span><br><span class="line">                    <span class="keyword">if</span> (!(c[i]&amp;c[k])&amp;&amp;!(c[j]&amp;c[k]))</span><br><span class="line">                        dp[d][j][k]=max(dp[d][j][k],dp[d<span class="number">-1</span>][i][j]+w[k]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=cnt;i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=cnt;j++)</span><br><span class="line">            ans=max(ans,dp[n][i][j]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;先预处理出一行内所有可行方案，记为&lt;script type=&quot;math/tex&quot;&gt;s&lt;/script&gt;，可以发现可行解并不多&lt;br&gt;再预处理出所有可行方案的炮兵数目，记为&lt;script type=&quot;math/tex&quot;&gt;w&lt;/script&gt;&lt;br&gt;用&lt;script type=&quot;math/tex&quot;&gt;dp\left [  d\right ]\left [  i\right ]\left [ j \right ]&lt;/script&gt;记录前&lt;script type=&quot;math/tex&quot;&gt;d&lt;/script&gt;行，且上一行状态为&lt;script type=&quot;math/tex&quot;&gt;s_{j}&lt;/script&gt;，上两行状态为&lt;script type=&quot;math/tex&quot;&gt;s_{i}&lt;/script&gt;的最大炮兵数目&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
dp\left [ d \right ]\left [ j \right ]\left [ k \right ]=max\left \{ dp\left [ d-1 \right ]\left [ i \right ]\left [ j \right ]\right \}&lt;/script&gt;&lt;p&gt;转移时需要判断状态之间是否合法，炮兵是否均在平原&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="DP" scheme="http://yoursite.com/tags/DP/"/>
    
      <category term="状态压缩" scheme="http://yoursite.com/tags/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9/"/>
    
  </entry>
  
  <entry>
    <title>[SDOI2013]直径</title>
    <link href="http://yoursite.com/2018/08/11/SDOI2013-%E7%9B%B4%E5%BE%84/"/>
    <id>http://yoursite.com/2018/08/11/SDOI2013-直径/</id>
    <published>2018-08-11T10:46:22.000Z</published>
    <updated>2018-08-11T10:58:11.265Z</updated>
    
    <content type="html"><![CDATA[<p>首先求一遍直径，记起点为<script type="math/tex">S</script>，终点为<script type="math/tex">T</script><br>所有可行边均在直径上<del>（废话）</del><br>考虑直径上某个点<script type="math/tex">x</script>，求出它不经过直径的能访问的最远距离，记为<script type="math/tex">d_{x}</script><br>复杂度<del>显然</del>是<script type="math/tex">O\left(N\right)​</script>的</p><p>从<script type="math/tex">S</script>到<script type="math/tex">T</script>，依次遍历直径上所有点</p><ul><li>若<script type="math/tex">d_{x}=D\left ( S,x \right )</script>，则<script type="math/tex">S</script>到<script type="math/tex">x</script>之间所有的边均不是必须经过的</li><li>若<script type="math/tex">d_{x}=D\left ( x,T \right )</script>，则<script type="math/tex">x</script>到<script type="math/tex">T</script>之间所有的边均不是必须经过的</li></ul><p>需要注意的是，有些算法在遇到第二种情况时需要及时退出<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">200050</span>;</span><br><span class="line"><span class="keyword">int</span> n,st,ed,fa[N],col[N],ans=<span class="number">0</span>;</span><br><span class="line">LL d[N],len;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; e[N],g[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch!=<span class="string">'-'</span>&amp;&amp;(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) t=<span class="number">-1</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) x=x*<span class="number">10</span>+ch<span class="number">-48</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[u].push_back(v);</span><br><span class="line">    g[u].push_back(val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> pre,<span class="keyword">int</span> &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (o==pre) d[o]=<span class="number">0</span>,fa[o]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (!x||d[o]&gt;d[x]) x=o;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;e[o].size();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> to=e[o][i];</span><br><span class="line">        <span class="keyword">if</span> (to!=pre)</span><br><span class="line">        &#123;</span><br><span class="line">            fa[to]=o;</span><br><span class="line">            d[to]=d[o]+g[o][i];</span><br><span class="line">            find(to,o,x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> o)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL ret=<span class="number">0</span>;</span><br><span class="line">    col[o]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;e[o].size();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> to=e[o][i];</span><br><span class="line">        <span class="keyword">if</span> (!col[to]) ret=max(ret,dfs(to)+g[o][i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n=read();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> u=read(),v=read();</span><br><span class="line">        <span class="keyword">int</span> val=read();</span><br><span class="line">        add(u,v,val);</span><br><span class="line">        add(v,u,val);</span><br><span class="line">    &#125;</span><br><span class="line">    find(n,n,ed);</span><br><span class="line">    find(ed,ed,st);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,len=d[st]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=st;i;i=fa[i]) col[i]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> f=<span class="number">0</span>,i=st;i&amp;&amp;!f;i=fa[i])</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;!f&amp;&amp;j&lt;e[i].size();j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> to=e[i][j];</span><br><span class="line">            <span class="keyword">if</span> (!col[to]) </span><br><span class="line">            &#123;</span><br><span class="line">                LL x=dfs(to)+g[i][j];</span><br><span class="line">                <span class="keyword">if</span> (x==len-d[i]) st=i;</span><br><span class="line">                <span class="keyword">if</span> (x==d[i]) ed=i,f=<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=st;i!=ed;i=fa[i]) ans++;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;首先求一遍直径，记起点为&lt;script type=&quot;math/tex&quot;&gt;S&lt;/script&gt;，终点为&lt;script type=&quot;math/tex&quot;&gt;T&lt;/script&gt;&lt;br&gt;所有可行边均在直径上&lt;del&gt;（废话）&lt;/del&gt;&lt;br&gt;考虑直径上某个点&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;，求出它不经过直径的能访问的最远距离，记为&lt;script type=&quot;math/tex&quot;&gt;d_{x}&lt;/script&gt;&lt;br&gt;复杂度&lt;del&gt;显然&lt;/del&gt;是&lt;script type=&quot;math/tex&quot;&gt;O\left(N\right)​&lt;/script&gt;的&lt;/p&gt;
&lt;p&gt;从&lt;script type=&quot;math/tex&quot;&gt;S&lt;/script&gt;到&lt;script type=&quot;math/tex&quot;&gt;T&lt;/script&gt;，依次遍历直径上所有点&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;若&lt;script type=&quot;math/tex&quot;&gt;d_{x}=D\left ( S,x \right )&lt;/script&gt;，则&lt;script type=&quot;math/tex&quot;&gt;S&lt;/script&gt;到&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;之间所有的边均不是必须经过的&lt;/li&gt;
&lt;li&gt;若&lt;script type=&quot;math/tex&quot;&gt;d_{x}=D\left ( x,T \right )&lt;/script&gt;，则&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;到&lt;script type=&quot;math/tex&quot;&gt;T&lt;/script&gt;之间所有的边均不是必须经过的&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;需要注意的是，有些算法在遇到第二种情况时需要及时退出&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="树形结构" scheme="http://yoursite.com/tags/%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84/"/>
    
      <category term="树的直径" scheme="http://yoursite.com/tags/%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84/"/>
    
  </entry>
  
  <entry>
    <title>扩展中国剩余定理</title>
    <link href="http://yoursite.com/2018/08/11/%E6%89%A9%E5%B1%95%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/"/>
    <id>http://yoursite.com/2018/08/11/扩展中国剩余定理/</id>
    <published>2018-08-11T10:32:36.000Z</published>
    <updated>2018-08-11T10:45:31.610Z</updated>
    
    <content type="html"><![CDATA[<script type="math/tex; mode=display">\left\{\begin{matrix} x\equiv a_{1}\left ( mod \ m_{1} \right )  \\ x\equiv a_{2}\left ( mod \ m_{2} \right )\\\cdots \\x\equiv a_{n}\left ( mod \ m_{n} \right )\\\end{matrix}\right.</script><p>不保证<script type="math/tex">m</script>两两互质</p><p>设已求出前<script type="math/tex">k</script>个方程的解，记为<script type="math/tex">x_{k}</script><br>记<script type="math/tex">M_{k}=\prod _{i=1}^{k}m_{i}</script><br>则<script type="math/tex">x_{k}+tM_{k}\left ( k \in\mathbb{Z} \right )</script>为前<script type="math/tex">k</script>个方程的通解</p><p>考虑第<script type="math/tex">k+1</script>个方程</p><script type="math/tex; mode=display">x_{k}+tM_{k} \equiv a_{k+1} \left ( mod \ m_{k+1}\right )</script><p>用<script type="math/tex">exgcd</script>解出<script type="math/tex">t</script><br>若无解则方程组无解<br>若有解则<script type="math/tex">x_{k+1}=x_{k}+tM_{k}</script><br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100050</span>;</span><br><span class="line">LL n,x,y,a[N],m[N],M=<span class="number">1</span>;</span><br><span class="line"><span class="function">LL <span class="title">mul</span><span class="params">(LL a,LL b,LL mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL ret=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(;b;b&gt;&gt;=<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (b&amp;<span class="number">1</span>) ret=(ret+a)%mod;</span><br><span class="line">        a=(a&lt;&lt;<span class="number">1</span>)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(LL a,LL b,LL &amp;x,LL &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) &#123;x=<span class="number">1</span>,y=<span class="number">0</span>;<span class="keyword">return</span>;&#125;</span><br><span class="line">    exgcd(b,a%b,y,x);</span><br><span class="line">    y-=a/b*x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">gcd</span><span class="params">(LL a,LL b)</span></span>&#123;<span class="keyword">return</span> b?gcd(b,a%b):a;&#125;</span><br><span class="line"><span class="function">LL <span class="title">exCRT</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL M=m[<span class="number">1</span>],ans=a[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        LL w=gcd(M,m[i]);</span><br><span class="line">        LL c=(a[i]-ans)%m[i]+m[i];</span><br><span class="line">        exgcd(M/w,m[i]/w,x,y);</span><br><span class="line">        x=mul(x,c%m[i]/w,m[i]);</span><br><span class="line">        ans+=x*M,M*=m[i]/w;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (ans%M+M)%M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;m[i],&amp;a[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,exCRT());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;script type=&quot;math/tex; mode=display&quot;&gt;
\left\{\begin{matrix}
 x\equiv a_{1}\left ( mod \ m_{1} \right )  \\ 
x\equiv a_{2}\left ( mod \ m_{2} \right )\\
\cdots \\
x\equiv a_{n}\left ( mod \ m_{n} \right )\\
\end{matrix}\right.&lt;/script&gt;&lt;p&gt;不保证&lt;script type=&quot;math/tex&quot;&gt;m&lt;/script&gt;两两互质&lt;/p&gt;
&lt;p&gt;设已求出前&lt;script type=&quot;math/tex&quot;&gt;k&lt;/script&gt;个方程的解，记为&lt;script type=&quot;math/tex&quot;&gt;x_{k}&lt;/script&gt;&lt;br&gt;记&lt;script type=&quot;math/tex&quot;&gt;M_{k}=\prod _{i=1}^{k}m_{i}&lt;/script&gt;&lt;br&gt;则&lt;script type=&quot;math/tex&quot;&gt;x_{k}+tM_{k}\left ( k \in\mathbb{Z} \right )&lt;/script&gt;为前&lt;script type=&quot;math/tex&quot;&gt;k&lt;/script&gt;个方程的通解&lt;/p&gt;
&lt;p&gt;考虑第&lt;script type=&quot;math/tex&quot;&gt;k+1&lt;/script&gt;个方程&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
x_{k}+tM_{k} \equiv a_{k+1} \left ( mod \ m_{k+1}\right )&lt;/script&gt;&lt;p&gt;用&lt;script type=&quot;math/tex&quot;&gt;exgcd&lt;/script&gt;解出&lt;script type=&quot;math/tex&quot;&gt;t&lt;/script&gt;&lt;br&gt;若无解则方程组无解&lt;br&gt;若有解则&lt;script type=&quot;math/tex&quot;&gt;x_{k+1}=x_{k}+tM_{k}&lt;/script&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="数论" scheme="http://yoursite.com/tags/%E6%95%B0%E8%AE%BA/"/>
    
      <category term="模板" scheme="http://yoursite.com/tags/%E6%A8%A1%E6%9D%BF/"/>
    
  </entry>
  
  <entry>
    <title>K短路</title>
    <link href="http://yoursite.com/2018/08/11/k%E7%9F%AD%E8%B7%AF/"/>
    <id>http://yoursite.com/2018/08/11/k短路/</id>
    <published>2018-08-11T10:08:00.000Z</published>
    <updated>2018-08-11T11:10:38.863Z</updated>
    
    <content type="html"><![CDATA[<p>其实<script type="math/tex">K</script>短路是有有理有据的做法的，<del>但我不会啊</del></p><p>建立一个以<script type="math/tex">d</script>为关键字的优先队列<br>放入<script type="math/tex">\left ( S,0 \right )</script>，然后进行扩展<br><del>易证</del>，当<script type="math/tex">\left ( x,d \right )</script>被第<script type="math/tex">K</script>次取出时，<script type="math/tex">d</script>为<script type="math/tex">S</script>到<script type="math/tex">x</script>的<script type="math/tex">K</script>短路</p><p>考虑用启发式优化来提高效率<br>到<script type="math/tex">T</script>的估计距离<script type="math/tex">f_{x}</script>可以为<script type="math/tex">x</script>到<script type="math/tex">T</script>的最短路<br>对于点<script type="math/tex">x</script>，<script type="math/tex">g_{x}=d_{now}+f_{x}</script><br>优先队列以<script type="math/tex">g</script>为关键字</p><p>还可以继续优化</p><ul><li>当取出其中某个点<script type="math/tex">K</script>次后，不需要将其再放入优先队列中</li><li>对于有距离要求的<script type="math/tex">K</script>短路，当取出元素的<script type="math/tex">d</script>大于给定值可直接退出</li></ul><a id="more"></a><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5050</span>,INF=<span class="number">1</span>&lt;&lt;<span class="number">30</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span><span class="keyword">int</span> to;<span class="keyword">double</span> val;&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span><span class="keyword">int</span> id;<span class="keyword">double</span> d;&#125;;</span><br><span class="line"><span class="keyword">int</span> n,m,ans=<span class="number">0</span>,inq[N],cnt[N];</span><br><span class="line"><span class="keyword">double</span> E,f[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt; e[N],r[N];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">cmp</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(node a,node b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a.d+f[a.id]&gt;b.d+f[b.id];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;node,<span class="built_in">vector</span>&lt;node&gt;,cmp&gt; S;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> ((ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&amp;&amp;ch!=<span class="string">'-'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) &#123;t=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span><span class="params">(<span class="keyword">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) f[i]=INF;</span><br><span class="line">    f[s]=<span class="number">0</span>,inq[s]=<span class="number">1</span>,Q.push(s);</span><br><span class="line">    <span class="keyword">while</span> (!Q.empty())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x=Q.front();</span><br><span class="line">        Q.pop(),inq[x]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;r[x].size();i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> to=r[x][i].to;</span><br><span class="line">            <span class="keyword">double</span> val=r[x][i].val;</span><br><span class="line">            <span class="keyword">if</span> (f[x]+val&lt;f[to])</span><br><span class="line">            &#123;</span><br><span class="line">                f[to]=f[x]+val;</span><br><span class="line">                <span class="keyword">if</span> (!inq[to]) inq[to]=<span class="number">1</span>,Q.push(to);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">A_star</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t,<span class="keyword">int</span> sz)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    S.push((node)&#123;s,<span class="number">0</span>&#125;);</span><br><span class="line">    <span class="keyword">while</span> (!S.empty())</span><br><span class="line">    &#123;</span><br><span class="line">        node x=S.top();</span><br><span class="line">        <span class="keyword">if</span> (cnt[x.id]&gt;sz) <span class="keyword">return</span>;</span><br><span class="line">        S.pop(),cnt[x.id]++;</span><br><span class="line">        <span class="keyword">if</span> (x.d&gt;E) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (x.id==t) </span><br><span class="line">        &#123;</span><br><span class="line">            ans++,E-=x.d;</span><br><span class="line">            sz=E/x.d;</span><br><span class="line">            <span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="keyword">sizeof</span>(cnt));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;e[x.id].size();i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> to=e[x.id][i].to;</span><br><span class="line">            <span class="keyword">double</span> val=e[x.id][i].val;</span><br><span class="line">            <span class="keyword">if</span> (x.d+val&lt;=E) S.push((node)&#123;to,x.d+val&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n=read(),m=read();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lf"</span>,&amp;E);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> u=read(),v=read();</span><br><span class="line">        <span class="keyword">double</span> val;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf"</span>,&amp;val);</span><br><span class="line">        e[u].push_back((edge)&#123;v,val&#125;);</span><br><span class="line">        r[v].push_back((edge)&#123;u,val&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    SPFA(n);</span><br><span class="line">    A_star(<span class="number">1</span>,n,E/f[<span class="number">1</span>]); </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;其实&lt;script type=&quot;math/tex&quot;&gt;K&lt;/script&gt;短路是有有理有据的做法的，&lt;del&gt;但我不会啊&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;建立一个以&lt;script type=&quot;math/tex&quot;&gt;d&lt;/script&gt;为关键字的优先队列&lt;br&gt;放入&lt;script type=&quot;math/tex&quot;&gt;\left ( S,0 \right )&lt;/script&gt;，然后进行扩展&lt;br&gt;&lt;del&gt;易证&lt;/del&gt;，当&lt;script type=&quot;math/tex&quot;&gt;\left ( x,d \right )&lt;/script&gt;被第&lt;script type=&quot;math/tex&quot;&gt;K&lt;/script&gt;次取出时，&lt;script type=&quot;math/tex&quot;&gt;d&lt;/script&gt;为&lt;script type=&quot;math/tex&quot;&gt;S&lt;/script&gt;到&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;的&lt;script type=&quot;math/tex&quot;&gt;K&lt;/script&gt;短路&lt;/p&gt;
&lt;p&gt;考虑用启发式优化来提高效率&lt;br&gt;到&lt;script type=&quot;math/tex&quot;&gt;T&lt;/script&gt;的估计距离&lt;script type=&quot;math/tex&quot;&gt;f_{x}&lt;/script&gt;可以为&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;到&lt;script type=&quot;math/tex&quot;&gt;T&lt;/script&gt;的最短路&lt;br&gt;对于点&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;，&lt;script type=&quot;math/tex&quot;&gt;g_{x}=d_{now}+f_{x}&lt;/script&gt;&lt;br&gt;优先队列以&lt;script type=&quot;math/tex&quot;&gt;g&lt;/script&gt;为关键字&lt;/p&gt;
&lt;p&gt;还可以继续优化&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当取出其中某个点&lt;script type=&quot;math/tex&quot;&gt;K&lt;/script&gt;次后，不需要将其再放入优先队列中&lt;/li&gt;
&lt;li&gt;对于有距离要求的&lt;script type=&quot;math/tex&quot;&gt;K&lt;/script&gt;短路，当取出元素的&lt;script type=&quot;math/tex&quot;&gt;d&lt;/script&gt;大于给定值可直接退出&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="模板" scheme="http://yoursite.com/tags/%E6%A8%A1%E6%9D%BF/"/>
    
      <category term="图论" scheme="http://yoursite.com/tags/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="A*" scheme="http://yoursite.com/tags/A/"/>
    
  </entry>
  
  <entry>
    <title>洛谷P1382 楼房</title>
    <link href="http://yoursite.com/2018/08/11/%E6%B4%9B%E8%B0%B7P1382-%E6%A5%BC%E6%88%BF/"/>
    <id>http://yoursite.com/2018/08/11/洛谷P1382-楼房/</id>
    <published>2018-08-11T09:53:02.000Z</published>
    <updated>2018-08-11T11:11:55.798Z</updated>
    
    <content type="html"><![CDATA[<p>线段树实现起来细节有点多，用了<em>multiset</em><br>参考了一下大佬的题解</p><p>排序时需要注意顺序问题</p><ul><li>先左后右</li><li>先入后出</li><li>入边从高到低</li><li>出边从低到高</li></ul><p>感性理解一下即可</p><p>加入边时考虑是否会变高<br>删除边时考虑是否会变低<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">200050</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span><span class="keyword">int</span> x,h,opt;&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dot</span>&#123;</span><span class="keyword">int</span> x,y;&#125;ans[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> n,cnt=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">multiset</span>&lt;<span class="keyword">int</span>&gt; S;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> ((ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&amp;&amp;ch!=<span class="string">'-'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) &#123;t=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a,node b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a.x!=b.x) <span class="keyword">return</span> a.x&lt;b.x;</span><br><span class="line">    <span class="keyword">if</span> (a.opt!=b.opt) <span class="keyword">return</span> a.opt&gt;b.opt;</span><br><span class="line">    <span class="keyword">if</span> (a.opt==<span class="number">1</span>) <span class="keyword">return</span> a.h&gt;b.h;</span><br><span class="line">    <span class="keyword">if</span> (a.opt==<span class="number">-1</span>) <span class="keyword">return</span> a.h&lt;b.h;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n=read();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> h=read(),l=read(),r=read();</span><br><span class="line">        t[i]=(node)&#123;l,h,<span class="number">1</span>&#125;;</span><br><span class="line">        t[i+n]=(node)&#123;r,h,<span class="number">-1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    n&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    sort(t+<span class="number">1</span>,t+n+<span class="number">1</span>,cmp);</span><br><span class="line">    S.insert(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> H=*S.rbegin();</span><br><span class="line">        <span class="keyword">if</span> (t[i].opt==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (t[i].h&gt;H) </span><br><span class="line">            &#123;</span><br><span class="line">                ans[++cnt]=(dot)&#123;t[i].x,H&#125;;</span><br><span class="line">                ans[++cnt]=(dot)&#123;t[i].x,t[i].h&#125;;</span><br><span class="line">                S.insert(t[i].h);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> S.insert(t[i].h);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (t[i].opt==<span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (t[i].h==H&amp;&amp;S.count(H)==<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                S.erase(H);</span><br><span class="line">                ans[++cnt]=(dot)&#123;t[i].x,H&#125;;</span><br><span class="line">                ans[++cnt]=(dot)&#123;t[i].x,*S.rbegin()&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> S.erase(S.find(t[i].h));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,cnt);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=cnt;i++) </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,ans[i].x,ans[i].y);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;线段树实现起来细节有点多，用了&lt;em&gt;multiset&lt;/em&gt;&lt;br&gt;参考了一下大佬的题解&lt;/p&gt;
&lt;p&gt;排序时需要注意顺序问题&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;先左后右&lt;/li&gt;
&lt;li&gt;先入后出&lt;/li&gt;
&lt;li&gt;入边从高到低&lt;/li&gt;
&lt;li&gt;出边从低到高&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;感性理解一下即可&lt;/p&gt;
&lt;p&gt;加入边时考虑是否会变高&lt;br&gt;删除边时考虑是否会变低&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="扫描线" scheme="http://yoursite.com/tags/%E6%89%AB%E6%8F%8F%E7%BA%BF/"/>
    
  </entry>
  
  <entry>
    <title>[USACO5.5]Picture</title>
    <link href="http://yoursite.com/2018/08/11/USACO5-5-Picture/"/>
    <id>http://yoursite.com/2018/08/11/USACO5-5-Picture/</id>
    <published>2018-08-11T08:26:49.000Z</published>
    <updated>2018-08-11T08:44:17.637Z</updated>
    
    <content type="html"><![CDATA[<p>扫描线参考<a href="https://cwher.github.io/2018/08/11/HDU1542-Atlantis" target="_blank" rel="noopener">HDU1542 Atlantis</a><br>可以横竖各做一遍<br>需要注意的是会重复计算，需要与上一次结果作差</p><p>也可以只做一遍<br>用<script type="math/tex">sz</script>数组记录宽度，<script type="math/tex">c</script>数组记录竖线数量<br>还需要<script type="math/tex">L</script>，<script type="math/tex">R</script>记录是否有左右端点竖线<br>需要注意的是端点竖线重合和顺序问题<br>高度相同时先做覆盖再做取消覆盖，否则会重叠线段会多次计算<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">2e4</span>+<span class="number">50</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span><span class="keyword">int</span> l,r,h,val;&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> n,cnt=<span class="number">0</span>,ans=<span class="number">0</span>,ql,qr;</span><br><span class="line"><span class="keyword">int</span> num[N&lt;&lt;<span class="number">2</span>],sz[N&lt;&lt;<span class="number">2</span>],w[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> c[N&lt;&lt;<span class="number">2</span>],L[N&lt;&lt;<span class="number">2</span>],R[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> ((ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&amp;&amp;ch!=<span class="string">'-'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) &#123;t=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a,node b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.h==b.h?a.val&gt;b.val:a.h&lt;b.h;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num[o])</span><br><span class="line">    &#123;</span><br><span class="line">        sz[o]=w[r+<span class="number">1</span>]-w[l];</span><br><span class="line">        c[o]=(L[o]=<span class="number">1</span>)+(R[o]=<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        L[o]=L[o&lt;&lt;<span class="number">1</span>],R[o]=R[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">        c[o]=c[o&lt;&lt;<span class="number">1</span>]+c[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">        c[o]-=(R[o&lt;&lt;<span class="number">1</span>]&amp;L[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>])&lt;&lt;<span class="number">1</span>;</span><br><span class="line">        sz[o]=sz[o&lt;&lt;<span class="number">1</span>]+sz[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ql&lt;=l&amp;&amp;r&lt;=qr)</span><br><span class="line">    &#123;</span><br><span class="line">        num[o]+=x;</span><br><span class="line">        calc(o,l,r);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (ql&lt;=mid) modify(o&lt;&lt;<span class="number">1</span>,l,mid,x);</span><br><span class="line">    <span class="keyword">if</span> (qr&gt;mid) modify(o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,x);</span><br><span class="line">    calc(o,l,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n=read();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x1=read(),y1=read();</span><br><span class="line">        <span class="keyword">int</span> x2=read(),y2=read();</span><br><span class="line">        w[i]=x1,w[i+n]=x2;</span><br><span class="line">        t[++cnt]=(node)&#123;x1,x2,y1,<span class="number">1</span>&#125;;</span><br><span class="line">        t[++cnt]=(node)&#123;x1,x2,y2,<span class="number">-1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    n&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    sort(w+<span class="number">1</span>,w+n+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> idx=unique(w+<span class="number">1</span>,w+n+<span class="number">1</span>)-w<span class="number">-1</span>;</span><br><span class="line">    sort(t+<span class="number">1</span>,t+n+<span class="number">1</span>,cmp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> pre=<span class="number">0</span>,i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ql=lower_bound(w+<span class="number">1</span>,w+idx+<span class="number">1</span>,t[i].l)-w;</span><br><span class="line">        qr=lower_bound(w+<span class="number">1</span>,w+idx+<span class="number">1</span>,t[i].r)-w<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span> (ql&lt;=qr) modify(<span class="number">1</span>,<span class="number">1</span>,idx,t[i].val);</span><br><span class="line">        ans+=c[<span class="number">1</span>]*(t[i+<span class="number">1</span>].h-t[i].h);</span><br><span class="line">        ans+=<span class="built_in">abs</span>(sz[<span class="number">1</span>]-pre),pre=sz[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;扫描线参考&lt;a href=&quot;https://cwher.github.io/2018/08/11/HDU1542-Atlantis&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;HDU1542 Atlantis&lt;/a&gt;&lt;br&gt;可以横竖各做一遍&lt;br&gt;需要注意的是会重复计算，需要与上一次结果作差&lt;/p&gt;
&lt;p&gt;也可以只做一遍&lt;br&gt;用&lt;script type=&quot;math/tex&quot;&gt;sz&lt;/script&gt;数组记录宽度，&lt;script type=&quot;math/tex&quot;&gt;c&lt;/script&gt;数组记录竖线数量&lt;br&gt;还需要&lt;script type=&quot;math/tex&quot;&gt;L&lt;/script&gt;，&lt;script type=&quot;math/tex&quot;&gt;R&lt;/script&gt;记录是否有左右端点竖线&lt;br&gt;需要注意的是端点竖线重合和顺序问题&lt;br&gt;高度相同时先做覆盖再做取消覆盖，否则会重叠线段会多次计算&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="扫描线" scheme="http://yoursite.com/tags/%E6%89%AB%E6%8F%8F%E7%BA%BF/"/>
    
      <category term="线段树" scheme="http://yoursite.com/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>HDU1255 覆盖的面积</title>
    <link href="http://yoursite.com/2018/08/11/HDU1255-%E8%A6%86%E7%9B%96%E7%9A%84%E9%9D%A2%E7%A7%AF/"/>
    <id>http://yoursite.com/2018/08/11/HDU1255-覆盖的面积/</id>
    <published>2018-08-11T08:19:11.000Z</published>
    <updated>2018-08-11T08:39:01.572Z</updated>
    
    <content type="html"><![CDATA[<p>扫描线参考<a href="https://cwher.github.io/2018/08/11/HDU1542-Atlantis" target="_blank" rel="noopener">HDU1542 Atlantis</a><br>需要修改的只有<script type="math/tex">calc</script>函数<br>用<script type="math/tex">sz</script>数组记录被覆盖到两次或以上的宽度<br>用<script type="math/tex">c</script>数组记录被覆盖到一次的宽度</p><p>具体细节看代码<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">2050</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span><span class="keyword">double</span> l,r,h;<span class="keyword">int</span> val;&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> num[N&lt;&lt;<span class="number">4</span>],ql,qr;</span><br><span class="line"><span class="keyword">double</span> sz[N&lt;&lt;<span class="number">4</span>],c[N&lt;&lt;<span class="number">4</span>],w[N&lt;&lt;<span class="number">4</span>];    <span class="comment">//2 1</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch!=<span class="string">'-'</span>&amp;&amp;(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) t=<span class="number">-1</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) x=x*<span class="number">10</span>+ch<span class="number">-48</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a,node b)</span></span>&#123;<span class="keyword">return</span> a.h&lt;b.h;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num[o]&gt;=<span class="number">2</span>) sz[o]=w[r+<span class="number">1</span>]-w[l];</span><br><span class="line">    <span class="keyword">if</span> (num[o]==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        c[o]=w[r+<span class="number">1</span>]-w[l];</span><br><span class="line">        sz[o]=c[o&lt;&lt;<span class="number">1</span>]+c[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!num[o])</span><br><span class="line">    &#123;</span><br><span class="line">        c[o]=c[o&lt;&lt;<span class="number">1</span>]+c[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">        sz[o]=sz[o&lt;&lt;<span class="number">1</span>]+sz[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ql&lt;=l&amp;&amp;r&lt;=qr)</span><br><span class="line">    &#123;</span><br><span class="line">        num[o]+=x;</span><br><span class="line">        calc(o,l,r);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (ql&lt;=mid) modify(o&lt;&lt;<span class="number">1</span>,l,mid,x);</span><br><span class="line">    <span class="keyword">if</span> (qr&gt;mid) modify(o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,x);</span><br><span class="line">    calc(o,l,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> Case=<span class="number">0</span>,T=read();</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">double</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> cnt=<span class="number">0</span>,n=read();</span><br><span class="line">        <span class="built_in">memset</span>(num,<span class="number">0</span>,<span class="keyword">sizeof</span>(num));</span><br><span class="line">        <span class="built_in">memset</span>(sz,<span class="number">0</span>,<span class="keyword">sizeof</span>(sz));</span><br><span class="line">        <span class="built_in">memset</span>(c,<span class="number">0</span>,<span class="keyword">sizeof</span>(c));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">double</span> x1,y1,x2,y2;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf%lf"</span>,&amp;x1,&amp;y1,&amp;x2,&amp;y2);</span><br><span class="line">            w[i]=x1,w[i+n]=x2;</span><br><span class="line">            t[++cnt]=(node)&#123;x1,x2,y1,<span class="number">1</span>&#125;;</span><br><span class="line">            t[++cnt]=(node)&#123;x1,x2,y2,<span class="number">-1</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        n&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">        sort(w+<span class="number">1</span>,w+n+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> idx=unique(w+<span class="number">1</span>,w+n+<span class="number">1</span>)-w<span class="number">-1</span>;</span><br><span class="line">        sort(t+<span class="number">1</span>,t+cnt+<span class="number">1</span>,cmp);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            ql=lower_bound(w+<span class="number">1</span>,w+idx+<span class="number">1</span>,t[i].l)-w;</span><br><span class="line">            qr=lower_bound(w+<span class="number">1</span>,w+idx+<span class="number">1</span>,t[i].r)-w<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">if</span> (ql&lt;=qr) modify(<span class="number">1</span>,<span class="number">1</span>,idx,t[i].val);</span><br><span class="line">            ans+=sz[<span class="number">1</span>]*(t[i+<span class="number">1</span>].h-t[i].h);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.2lf\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;扫描线参考&lt;a href=&quot;https://cwher.github.io/2018/08/11/HDU1542-Atlantis&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;HDU1542 Atlantis&lt;/a&gt;&lt;br&gt;需要修改的只有&lt;script type=&quot;math/tex&quot;&gt;calc&lt;/script&gt;函数&lt;br&gt;用&lt;script type=&quot;math/tex&quot;&gt;sz&lt;/script&gt;数组记录被覆盖到两次或以上的宽度&lt;br&gt;用&lt;script type=&quot;math/tex&quot;&gt;c&lt;/script&gt;数组记录被覆盖到一次的宽度&lt;/p&gt;
&lt;p&gt;具体细节看代码&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="扫描线" scheme="http://yoursite.com/tags/%E6%89%AB%E6%8F%8F%E7%BA%BF/"/>
    
      <category term="线段树" scheme="http://yoursite.com/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>[USACO07OPEN]城市的地平线</title>
    <link href="http://yoursite.com/2018/08/11/USACO07OPEN-%E5%9F%8E%E5%B8%82%E7%9A%84%E5%9C%B0%E5%B9%B3%E7%BA%BF/"/>
    <id>http://yoursite.com/2018/08/11/USACO07OPEN-城市的地平线/</id>
    <published>2018-08-11T08:16:07.000Z</published>
    <updated>2018-08-11T08:37:31.542Z</updated>
    
    <content type="html"><![CDATA[<p>竖版的扫描线<br>扫描线参考<a href="https://cwher.github.io/2018/08/11/HDU1542-Atlantis" target="_blank" rel="noopener">HDU1542 Atlantis</a><br><a id="more"></a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">80050</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span><span class="keyword">int</span> x,h,val;&#125;t[N];</span><br><span class="line"><span class="keyword">int</span> n,cnt=<span class="number">0</span>,ql,qr,w[N];</span><br><span class="line">LL ans=<span class="number">0</span>,sz[N&lt;&lt;<span class="number">4</span>],num[N&lt;&lt;<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> ((ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&amp;&amp;ch!=<span class="string">'-'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) &#123;t=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num[o])</span><br><span class="line">        sz[o]=w[r+<span class="number">1</span>]-w[l];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        sz[o]=sz[o&lt;&lt;<span class="number">1</span>]+sz[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ql&lt;=l&amp;&amp;r&lt;=qr)</span><br><span class="line">    &#123;</span><br><span class="line">        num[o]+=x;</span><br><span class="line">        calc(o,l,r);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (ql&lt;=mid) modify(o&lt;&lt;<span class="number">1</span>,l,mid,x);</span><br><span class="line">    <span class="keyword">if</span> (qr&gt;mid) modify(o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,x);</span><br><span class="line">    calc(o,l,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a,node b)</span></span>&#123;<span class="keyword">return</span> a.x&lt;b.x;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n=read();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> l=read(),r=read(),h;</span><br><span class="line">        w[i]=h=read();</span><br><span class="line">        t[++cnt]=(node)&#123;l,h,<span class="number">1</span>&#125;;</span><br><span class="line">        t[++cnt]=(node)&#123;r,h,<span class="number">-1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    w[n+<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    sort(w+<span class="number">1</span>,w+n+<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">int</span> idx=unique(w+<span class="number">1</span>,w+n+<span class="number">2</span>)-w<span class="number">-1</span>;</span><br><span class="line">    n&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    sort(t+<span class="number">1</span>,t+n+<span class="number">1</span>,cmp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ql=<span class="number">1</span>,qr=lower_bound(w+<span class="number">1</span>,w+idx+<span class="number">1</span>,t[i].h)-w<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span> (ql&lt;=qr) modify(<span class="number">1</span>,<span class="number">1</span>,n,t[i].val);</span><br><span class="line">        ans+=sz[<span class="number">1</span>]*((LL)t[i+<span class="number">1</span>].x-t[i].x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;竖版的扫描线&lt;br&gt;扫描线参考&lt;a href=&quot;https://cwher.github.io/2018/08/11/HDU1542-Atlantis&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;HDU1542 Atlantis&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="扫描线" scheme="http://yoursite.com/tags/%E6%89%AB%E6%8F%8F%E7%BA%BF/"/>
    
      <category term="线段树" scheme="http://yoursite.com/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>HDU1542 Atlantis</title>
    <link href="http://yoursite.com/2018/08/11/HDU1542-Atlantis/"/>
    <id>http://yoursite.com/2018/08/11/HDU1542-Atlantis/</id>
    <published>2018-08-11T08:07:07.000Z</published>
    <updated>2018-08-11T10:02:48.242Z</updated>
    
    <content type="html"><![CDATA[<p>扫描线入门题</p><p>借用一下某位大佬的图<br><img src="/2018/08/11/HDU1542-Atlantis/1.JPG" alt="T1"><br><img src="/2018/08/11/HDU1542-Atlantis/2.JPG" alt="T2"><br><img src="/2018/08/11/HDU1542-Atlantis/3.JPG" alt="T3"><br><img src="/2018/08/11/HDU1542-Atlantis/4.JPG" alt="T4"><br><img src="/2018/08/11/HDU1542-Atlantis/5.JPG" alt="T5"><br><img src="/2018/08/11/HDU1542-Atlantis/6.JPG" alt="T6"></p><p>先离散化横坐标<br>每个矩形分成上下两条线，下入上出<br>用<script type="math/tex">sz</script>数组记录当前区间被覆盖宽度<br>具体细节看代码<br><a id="more"></a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">205</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span><span class="keyword">double</span> l,r,h;<span class="keyword">int</span> val;&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> num[N&lt;&lt;<span class="number">4</span>],ql,qr;</span><br><span class="line"><span class="keyword">double</span> sz[N&lt;&lt;<span class="number">4</span>],w[N&lt;&lt;<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch!=<span class="string">'-'</span>&amp;&amp;(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) t=<span class="number">-1</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) x=x*<span class="number">10</span>+ch<span class="number">-48</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a,node b)</span></span>&#123;<span class="keyword">return</span> a.h&lt;b.h;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num[o])<span class="comment">//full</span></span><br><span class="line">        sz[o]=w[r+<span class="number">1</span>]-w[l];</span><br><span class="line">    <span class="keyword">else</span>    <span class="comment">//not</span></span><br><span class="line">        sz[o]=sz[o&lt;&lt;<span class="number">1</span>]+sz[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ql&lt;=l&amp;&amp;r&lt;=qr)</span><br><span class="line">    &#123;</span><br><span class="line">        num[o]+=x;</span><br><span class="line">        calc(o,l,r);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (ql&lt;=mid) modify(o&lt;&lt;<span class="number">1</span>,l,mid,x);</span><br><span class="line">    <span class="keyword">if</span> (qr&gt;mid) modify(o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,x);</span><br><span class="line">    calc(o,l,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> Case=<span class="number">0</span>,n;</span><br><span class="line">    <span class="keyword">while</span> (n=read())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">double</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(num,<span class="number">0</span>,<span class="keyword">sizeof</span>(num));</span><br><span class="line">        <span class="built_in">memset</span>(sz,<span class="number">0</span>,<span class="keyword">sizeof</span>(sz));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">double</span> x1,y1,x2,y2;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf%lf"</span>,&amp;x1,&amp;y1,&amp;x2,&amp;y2);</span><br><span class="line">            w[i]=x1,w[i+n]=x2;</span><br><span class="line">            t[++cnt]=(node)&#123;x1,x2,y1,<span class="number">1</span>&#125;;</span><br><span class="line">            t[++cnt]=(node)&#123;x1,x2,y2,<span class="number">-1</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        n&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">        sort(w+<span class="number">1</span>,w+n+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> idx=unique(w+<span class="number">1</span>,w+n+<span class="number">1</span>)-w<span class="number">-1</span>;</span><br><span class="line">        sort(t+<span class="number">1</span>,t+cnt+<span class="number">1</span>,cmp);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            ql=lower_bound(w+<span class="number">1</span>,w+idx+<span class="number">1</span>,t[i].l)-w;</span><br><span class="line">            qr=lower_bound(w+<span class="number">1</span>,w+idx+<span class="number">1</span>,t[i].r)-w<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">if</span> (ql&lt;=qr) modify(<span class="number">1</span>,<span class="number">1</span>,idx,t[i].val);</span><br><span class="line">            ans+=sz[<span class="number">1</span>]*(t[i+<span class="number">1</span>].h-t[i].h);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.2lf\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;扫描线入门题&lt;/p&gt;
&lt;p&gt;借用一下某位大佬的图&lt;br&gt;&lt;img src=&quot;/2018/08/11/HDU1542-Atlantis/1.JPG&quot; alt=&quot;T1&quot;&gt;&lt;br&gt;&lt;img src=&quot;/2018/08/11/HDU1542-Atlantis/2.JPG&quot; alt=&quot;T2&quot;&gt;&lt;br&gt;&lt;img src=&quot;/2018/08/11/HDU1542-Atlantis/3.JPG&quot; alt=&quot;T3&quot;&gt;&lt;br&gt;&lt;img src=&quot;/2018/08/11/HDU1542-Atlantis/4.JPG&quot; alt=&quot;T4&quot;&gt;&lt;br&gt;&lt;img src=&quot;/2018/08/11/HDU1542-Atlantis/5.JPG&quot; alt=&quot;T5&quot;&gt;&lt;br&gt;&lt;img src=&quot;/2018/08/11/HDU1542-Atlantis/6.JPG&quot; alt=&quot;T6&quot;&gt;&lt;/p&gt;
&lt;p&gt;先离散化横坐标&lt;br&gt;每个矩形分成上下两条线，下入上出&lt;br&gt;用&lt;script type=&quot;math/tex&quot;&gt;sz&lt;/script&gt;数组记录当前区间被覆盖宽度&lt;br&gt;具体细节看代码&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="扫描线" scheme="http://yoursite.com/tags/%E6%89%AB%E6%8F%8F%E7%BA%BF/"/>
    
      <category term="线段树" scheme="http://yoursite.com/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>洛谷P4388 付公主的矩形</title>
    <link href="http://yoursite.com/2018/08/11/%E6%B4%9B%E8%B0%B7P4388-%E4%BB%98%E5%85%AC%E4%B8%BB%E7%9A%84%E7%9F%A9%E5%BD%A2/"/>
    <id>http://yoursite.com/2018/08/11/洛谷P4388-付公主的矩形/</id>
    <published>2018-08-11T07:20:14.000Z</published>
    <updated>2018-08-11T07:52:42.266Z</updated>
    
    <content type="html"><![CDATA[<p>首先有一个结论<br>对于一个<script type="math/tex">\left ( r,c \right ), \ gcd\left ( r,c \right )=1</script>的矩形，经过格子数目为<script type="math/tex">r+c-1</script>个<br>更一般的，可由上式化简，对于<script type="math/tex">\left ( r,c \right )</script>，经过格子数目为<script type="math/tex">r+c-gcd\left ( r,c \right )</script></p><p>证明有多种<br>给出一种我当时想出来的</p><ul><li><script type="math/tex">\left ( r,c \right )</script>中对角线只有初末位置在格点上</li><li>当对角线穿过某一网格边时，必然会在两边经过各一个格子</li><li>对角线穿过的网格边数显然为<script type="math/tex">r+c-2</script></li><li>由于中间无格点，按照上述计算时中间每个格子会被计算到两次</li><li>初末位置的格子仅会被计算到一次</li><li>化简后可得格子数为<script type="math/tex">r+c-1</script></li></ul><p>暴力统计就能过了，复杂度比较玄学，大概是<script type="math/tex">O\left ( c*ans \right )</script>，<script type="math/tex">c</script>为一个不是很大常数<del>（我猜的）</del></p><p>其实还有更有理有据的做法</p><script type="math/tex; mode=display">\sum _{d\mid n}\sum \left [r+c=d+1,gcd\left ( r,c \right )=1  \right ]= \frac{\sum _{d\mid n}\varphi\left ( d+1 \right )+1}{2}</script><p>每一对<script type="math/tex">\left ( r,c \right )</script>都会被算到两次，但<script type="math/tex">\left ( n,n \right )</script>只会被算到一次<br>复杂度<script type="math/tex">O\left ( N \right )</script></p><p>代码为暴力统计<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e6</span>+<span class="number">50</span>;</span><br><span class="line"><span class="keyword">int</span> n,ans=<span class="number">0</span>,idx=<span class="number">0</span>,w[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?gcd(b,a%b):a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i*i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">if</span> (n%i==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            w[++idx]=i;</span><br><span class="line">            <span class="keyword">if</span> (i*i!=n) w[++idx]=n/i;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=idx;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> sz=w[i]+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=sz/<span class="number">2</span>;k++)</span><br><span class="line">            <span class="keyword">if</span> (gcd(k,sz-k)==<span class="number">1</span>) ans++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;首先有一个结论&lt;br&gt;对于一个&lt;script type=&quot;math/tex&quot;&gt;\left ( r,c \right ), \ gcd\left ( r,c \right )=1&lt;/script&gt;的矩形，经过格子数目为&lt;script type=&quot;math/tex&quot;&gt;r+c-1&lt;/script&gt;个&lt;br&gt;更一般的，可由上式化简，对于&lt;script type=&quot;math/tex&quot;&gt;\left ( r,c \right )&lt;/script&gt;，经过格子数目为&lt;script type=&quot;math/tex&quot;&gt;r+c-gcd\left ( r,c \right )&lt;/script&gt;&lt;/p&gt;
&lt;p&gt;证明有多种&lt;br&gt;给出一种我当时想出来的&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;script type=&quot;math/tex&quot;&gt;\left ( r,c \right )&lt;/script&gt;中对角线只有初末位置在格点上&lt;/li&gt;
&lt;li&gt;当对角线穿过某一网格边时，必然会在两边经过各一个格子&lt;/li&gt;
&lt;li&gt;对角线穿过的网格边数显然为&lt;script type=&quot;math/tex&quot;&gt;r+c-2&lt;/script&gt;&lt;/li&gt;
&lt;li&gt;由于中间无格点，按照上述计算时中间每个格子会被计算到两次&lt;/li&gt;
&lt;li&gt;初末位置的格子仅会被计算到一次&lt;/li&gt;
&lt;li&gt;化简后可得格子数为&lt;script type=&quot;math/tex&quot;&gt;r+c-1&lt;/script&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;暴力统计就能过了，复杂度比较玄学，大概是&lt;script type=&quot;math/tex&quot;&gt;O\left ( c*ans \right )&lt;/script&gt;，&lt;script type=&quot;math/tex&quot;&gt;c&lt;/script&gt;为一个不是很大常数&lt;del&gt;（我猜的）&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;其实还有更有理有据的做法&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\sum _{d\mid n}\sum \left [r+c=d+1,gcd\left ( r,c \right )=1  \right ]= \frac{\sum _{d\mid n}\varphi\left ( d+1 \right )+1}{2}&lt;/script&gt;&lt;p&gt;每一对&lt;script type=&quot;math/tex&quot;&gt;\left ( r,c \right )&lt;/script&gt;都会被算到两次，但&lt;script type=&quot;math/tex&quot;&gt;\left ( n,n \right )&lt;/script&gt;只会被算到一次&lt;br&gt;复杂度&lt;script type=&quot;math/tex&quot;&gt;O\left ( N \right )&lt;/script&gt;&lt;/p&gt;
&lt;p&gt;代码为暴力统计&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="数论" scheme="http://yoursite.com/tags/%E6%95%B0%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>[SCOI2005]骑士精神</title>
    <link href="http://yoursite.com/2018/08/11/SCOI2005-%E9%AA%91%E5%A3%AB%E7%B2%BE%E7%A5%9E/"/>
    <id>http://yoursite.com/2018/08/11/SCOI2005-骑士精神/</id>
    <published>2018-08-11T07:09:16.000Z</published>
    <updated>2018-08-11T12:28:41.983Z</updated>
    
    <content type="html"><![CDATA[<p>每次移动空位而不是骑士</p><p>设当前搜到第<script type="math/tex">k</script>步，剩下<script type="math/tex">num</script>个骑士未回到位置<br>若<script type="math/tex">k+num>dep_{now}</script>，则返回<br><del>跑得飞快</del></p><p>其实还可以加点什么小剪枝<br>若当前和<script type="math/tex">\left ( x,y \right )</script>交换，则下次不换回去<br>既然直接搜能过<del>（实现起来有点小烦）</del>，就没加这个剪枝<br><a id="more"></a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> n=<span class="number">5</span>,N=<span class="number">6</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> dx[]=&#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">2</span>,<span class="number">-2</span>,<span class="number">2</span>,<span class="number">-2</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> dy[]=&#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">-2</span>,<span class="number">-2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">-1</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> to[N][N]=&#123;&#123;<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'0'</span>&#125;,</span><br><span class="line">                    &#123;<span class="string">'0'</span>,<span class="string">'1'</span>,<span class="string">'1'</span>,<span class="string">'1'</span>,<span class="string">'1'</span>,<span class="string">'1'</span>&#125;,</span><br><span class="line">                    &#123;<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'1'</span>,<span class="string">'1'</span>,<span class="string">'1'</span>,<span class="string">'1'</span>&#125;,</span><br><span class="line">                    &#123;<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'*'</span>,<span class="string">'1'</span>,<span class="string">'1'</span>&#125;,</span><br><span class="line">                    &#123;<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'1'</span>&#125;,</span><br><span class="line">                    &#123;<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'0'</span>&#125;&#125;;</span><br><span class="line"><span class="keyword">int</span> dep,w[N][N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=<span class="number">0</span>,t=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> ((ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&amp;&amp;ch!=<span class="string">'-'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (ch==<span class="string">'-'</span>) &#123;t=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">get</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch!=<span class="string">'1'</span>&amp;&amp;ch!=<span class="string">'0'</span>&amp;&amp;ch!=<span class="string">'*'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">return</span> ch;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> k,<span class="keyword">int</span> xx,<span class="keyword">int</span> yy,<span class="keyword">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k+num&gt;dep) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (!num) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x=xx+dx[i],y=yy+dy[i];</span><br><span class="line">        <span class="keyword">if</span> (x&gt;<span class="number">0</span>&amp;&amp;x&lt;=n&amp;&amp;y&gt;<span class="number">0</span>&amp;&amp;y&lt;=n)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> nxt=num;</span><br><span class="line">            nxt+=w[x][y]==to[x][y];</span><br><span class="line">            nxt-=w[x][y]==to[xx][yy];</span><br><span class="line">            swap(w[x][y],w[xx][yy]);</span><br><span class="line">            <span class="keyword">if</span> (dfs(k+<span class="number">1</span>,x,y,nxt)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            swap(w[x][y],w[xx][yy]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T=read();</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> num=<span class="number">0</span>,f=<span class="number">0</span>,xx,yy;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">            &#123;</span><br><span class="line">                w[i][j]=get();</span><br><span class="line">                <span class="keyword">if</span> (to[i][j]!=w[i][j]&amp;&amp;w[i][j]!=<span class="string">'*'</span>) num++;</span><br><span class="line">                <span class="keyword">if</span> (w[i][j]==<span class="string">'*'</span>) xx=i,yy=j;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">for</span>(dep=num;dep&lt;=<span class="number">15</span>&amp;&amp;!f;dep++)</span><br><span class="line">            <span class="keyword">if</span> (dfs(<span class="number">0</span>,xx,yy,num)) </span><br><span class="line">                f=<span class="number">1</span>,<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,dep);</span><br><span class="line">        <span class="keyword">if</span> (!f) <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;每次移动空位而不是骑士&lt;/p&gt;
&lt;p&gt;设当前搜到第&lt;script type=&quot;math/tex&quot;&gt;k&lt;/script&gt;步，剩下&lt;script type=&quot;math/tex&quot;&gt;num&lt;/script&gt;个骑士未回到位置&lt;br&gt;若&lt;script type=&quot;math/tex&quot;&gt;k+num&gt;dep_{now}&lt;/script&gt;，则返回&lt;br&gt;&lt;del&gt;跑得飞快&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;其实还可以加点什么小剪枝&lt;br&gt;若当前和&lt;script type=&quot;math/tex&quot;&gt;\left ( x,y \right )&lt;/script&gt;交换，则下次不换回去&lt;br&gt;既然直接搜能过&lt;del&gt;（实现起来有点小烦）&lt;/del&gt;，就没加这个剪枝&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="A*" scheme="http://yoursite.com/tags/A/"/>
    
      <category term="IDA*" scheme="http://yoursite.com/tags/IDA/"/>
    
  </entry>
  
  <entry>
    <title>[NOI1999]生日蛋糕</title>
    <link href="http://yoursite.com/2018/08/11/NOI1999-%E7%94%9F%E6%97%A5%E8%9B%8B%E7%B3%95/"/>
    <id>http://yoursite.com/2018/08/11/NOI1999-生日蛋糕/</id>
    <published>2018-08-11T06:37:07.000Z</published>
    <updated>2018-08-11T07:06:42.522Z</updated>
    
    <content type="html"><![CDATA[<p>很综合的一道搜索题</p><p>从下往上搜<br>记<script type="math/tex">v\left [ k \right ]</script>为<em>1-k</em> 层最小体积，<script type="math/tex">s\left [ k \right ]</script>为<em>1-k</em> 层最小面积<br>记<script type="math/tex">V</script>为剩余体积，<script type="math/tex">S</script>为当前面积<br>对于第<script type="math/tex">k</script>层</p><script type="math/tex; mode=display">h_{k}\in \left [ k,min\left ( h_{k+1} -1,\frac{V-v\left [ k-1 \right ]}{k^{2}}\right ) \right ]</script><script type="math/tex; mode=display">r_{k}\in \left [  k,min\left ( r_{k+1}-1,\sqrt{\frac{\left ( V-v\left [ k-1 \right ] \right )}{h_{k}} }\right )\right ]</script><p>可行性剪枝</p><ul><li>若<script type="math/tex">V>v\left [ k \right ]</script>，则返回</li></ul><p>最优化剪枝</p><ul><li>若<script type="math/tex">S+s\left [ k \right ]>ans</script>，则返回</li><li>若<script type="math/tex">S+\frac{2V}{r_{k+1}}>ans</script>，则返回</li></ul><p>对于最后一种剪枝的证明</p><script type="math/tex; mode=display">\sum_{i=1}^{k}2r_{i}h_{i}>\frac{2}{r_{k+1}}\sum_{i=1}^{k}r_{i}^{2}h_{i}=\frac{2V}{r_{k+1}}</script><a id="more"></a><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF=<span class="number">1</span>&lt;&lt;<span class="number">30</span>,N=<span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,v[N],s[N],ans=INF;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> V,<span class="keyword">int</span> k,<span class="keyword">int</span> H,<span class="keyword">int</span> R,<span class="keyword">int</span> S)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k&lt;=<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!V) ans=min(ans,S);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (V&lt;v[k]) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (S+s[k]&gt;ans) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (S+<span class="number">2</span>*V/R&gt;ans) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> h=min(H<span class="number">-1</span>,(V-v[k<span class="number">-1</span>])/(k*k));h&gt;=k;h--)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> r=min(R<span class="number">-1</span>,(<span class="keyword">int</span>)<span class="built_in">sqrt</span>((V-v[k<span class="number">-1</span>])/h));r&gt;=k;r--)</span><br><span class="line">            dfs(V-r*r*h,k<span class="number">-1</span>,h,r,S+<span class="number">2</span>*r*h+r*r*(k==m));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v[i]=v[i<span class="number">-1</span>]+i*i*i;</span><br><span class="line">        s[i]=s[i<span class="number">-1</span>]+<span class="number">2</span>*i*i;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(n,m,INF,INF,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans==INF?<span class="number">0</span>:ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;很综合的一道搜索题&lt;/p&gt;
&lt;p&gt;从下往上搜&lt;br&gt;记&lt;script type=&quot;math/tex&quot;&gt;v\left [ k \right ]&lt;/script&gt;为&lt;em&gt;1-k&lt;/em&gt; 层最小体积，&lt;script type=&quot;math/tex&quot;&gt;s\left [ k \right ]&lt;/script&gt;为&lt;em&gt;1-k&lt;/em&gt; 层最小面积&lt;br&gt;记&lt;script type=&quot;math/tex&quot;&gt;V&lt;/script&gt;为剩余体积，&lt;script type=&quot;math/tex&quot;&gt;S&lt;/script&gt;为当前面积&lt;br&gt;对于第&lt;script type=&quot;math/tex&quot;&gt;k&lt;/script&gt;层&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
h_{k}\in \left [ k,min\left ( h_{k+1} -1,\frac{V-v\left [ k-1 \right ]}{k^{2}}\right ) \right ]&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
r_{k}\in \left [  k,min\left ( r_{k+1}-1,\sqrt{\frac{\left ( V-v\left [ k-1 \right ] \right )}{h_{k}} }\right )\right ]&lt;/script&gt;&lt;p&gt;可行性剪枝&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;若&lt;script type=&quot;math/tex&quot;&gt;V&gt;v\left [ k \right ]&lt;/script&gt;，则返回&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;最优化剪枝&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;若&lt;script type=&quot;math/tex&quot;&gt;S+s\left [ k \right ]&gt;ans&lt;/script&gt;，则返回&lt;/li&gt;
&lt;li&gt;若&lt;script type=&quot;math/tex&quot;&gt;S+\frac{2V}{r_{k+1}}&gt;ans&lt;/script&gt;，则返回&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对于最后一种剪枝的证明&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\sum_{i=1}^{k}2r_{i}h_{i}&gt;\frac{2}{r_{k+1}}\sum_{i=1}^{k}r_{i}^{2}h_{i}=\frac{2V}{r_{k+1}}&lt;/script&gt;
    
    </summary>
    
      <category term="OI" scheme="http://yoursite.com/categories/OI/"/>
    
    
      <category term="搜索" scheme="http://yoursite.com/tags/%E6%90%9C%E7%B4%A2/"/>
    
  </entry>
  
</feed>
